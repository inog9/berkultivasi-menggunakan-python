import os

def hash_directory(directory, algorithm="sha256"):
    hashes = {}
    for root, _, files in os.walk(directory):
        for file in files:
            filepath = os.path.join(root, file)
            try:
                file_hash = calculate_hash(filepath, algorithm)
                hashes[filepath] = file_hash
            except Exception as e:
                print(f"Error hashing {filepath}: {e}")
    return hashes

# Example
hashes = hash_directory("malware_samples/")
for path, digest in hashes.items():
    print(f"{digest}  {path}")
